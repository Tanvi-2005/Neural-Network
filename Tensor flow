import tensorflow as tf
import numpy as np

# Very small dataset
texts = tf.constant([
    "Win money now",
    "Congratulations! You won",
    "Low interest loan",
    "Hi how are you",
    "Let's meet tomorrow",
])

labels = tf.constant([1, 1, 1, 0, 0], dtype=tf.float32)

# Vectorization
vec = tf.keras.layers.TextVectorization(max_tokens=1000, output_sequence_length=10)
vec.adapt(texts)

X = vec(texts)                     # This is a tensor of word IDs
y = tf.expand_dims(labels, axis=1)

# Build model manually using Keras layers (still tensors)
model = tf.keras.Sequential([
    tf.keras.layers.Embedding(1000, 16),
    tf.keras.layers.GlobalAveragePooling1D(),
    tf.keras.layers.Dense(1, activation="sigmoid")
])

model.compile(optimizer="adam", loss="binary_crossentropy", metrics=["accuracy"])

model.fit(X, y, epochs=10)

# Predict
msg = "You won a free prize"
msg_tensor = vec(tf.constant([msg]))

pred = model.predict(msg_tensor)[0][0]
print("SPAM" if pred > 0.5 else "HAM")
